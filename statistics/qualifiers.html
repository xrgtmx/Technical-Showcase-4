<!DOCTYPE html>
<!-- 
	Statistics - Qualifiers
	-----------------------------------------
	Technical Showcase 4
	Website designed by Ryan "xRGTMx" Gudonis
	© 2020
	-->
<html>
	<head>
		<!-- Main Meta -->
		<meta charset="utf-8">
		<title>Statistics - Qualifiers | Technical Showcase 4</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<meta name="author" description="Ryan 'xRGTMx' Gudonis">
		<!-- Open Graph data -->
		<meta property="og:title" content="Statistics - Qualifiers | Technical Showcase 4">
		<meta property="og:type" content="article">
		<meta property="og:url" content="https://xrgtmx.github.io/Technical-Showcase-4/statistics/qualifiers.html">
		<meta property="og:image" content="https://xrgtmx.github.io/Technical-Showcase-4/img/ts4-og.jpg">
		<meta property="og:site_name" content="xrgtmx.github.io">
		<!-- Twitter Card data -->
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@xRGTMx">
		<meta name="twitter:title" content="Statistics - Qualifiers | Technical Showcase 4">
		<meta name="twitter:creator" content="@xRGTMx">
		<meta name="twitter:image:src" content="https://xrgtmx.github.io/Technical-Showcase-4/img/ts4-tw.jpg">
		<!-- Schema.org markup for Google+ -->
		<meta itemprop="name" content="Statistics - Qualifiers | Technical Showcase 4">
		<meta itemprop="image" content="https://xrgtmx.github.io/Technical-Showcase-4/img/ts4-og.jpg">
		<!-- Icon/Identity -->
		<link rel="shortcut icon" href="../img/ts4-identity.png">
		<link rel="icon" href="../img/ts4-identity-32.png" sizes="32x32">
		<link rel="icon" href="../img/ts4-identity-192.png" sizes="192x192">
		<link rel="apple-touch-icon-precomposed" href="../img/ts4-identity-180.png">
		<meta name="msapplication-TileImage" content="../img/ts4-identity-270.png">
		<!-- Stylesheets -->
		<link href="https://fonts.googleapis.com/css?family=Inter:400,500,700|Work+Sans:900" rel="stylesheet">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
		<link rel="stylesheet" type="text/css" href="../css/main.css">
		<link rel="stylesheet" type="text/css" href="../css/statistics.css">
		<!-- Scripts -->
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
	</head>
	<body>
		<!-- Header -->
		<div id="header">
			<!-- Navbar -->
			<nav class="navbar navbar-expand-lg">
				<div class="container">
					<!-- Brand -->
					<a class="navbar-brand" href="../about.html">
					<img alt="Technical Showcase 4" src="../img/ts4-logo.svg" width="160px" height="auto">
					</a>
					<!-- Toggler -->
					<button class="navbar-toggler navbar-light" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
					</button>
					<!-- Toggled Content -->
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav mr-auto">
							<!-- About -->
							<li class="nav-item">
								<a class="nav-link" href="../about.html">About</a>
							</li>
							<!-- Guidelines -->
							<li class="nav-item">
								<a class="nav-link" href="../guidelines.html">Guidelines</a>
							</li>
							<!-- Statistics -->
							<li class="nav-item dropdown active">
								<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownStatistics" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								Statistics
								</a>
								<!-- Statistics Dropdown Menu -->
								<div class="dropdown-menu" aria-labelledby="navbarDropdownStatistics">
									<!-- Round 1 -->
									<a class="dropdown-item active" href="qualifiers.html">Qualifiers</a>
									<!-- Grand Finals -->
									<a class="dropdown-item" href="finals.html" style="display: none;">Finals</a>
								</div>
							</li>
							<!-- Results -->
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownResults" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								Results
								</a>
								<!-- Results Dropdown Menu -->
								<div class="dropdown-menu" aria-labelledby="navbarDropdownResults">
									<!-- Round 1 -->
									<a class="dropdown-item" href="../results/qualifiers.html">Qualifiers</a>
									<!-- Grand Finals -->
									<a class="dropdown-item" href="../results/finals.html" style="display: none;">Finals</a>
								</div>
							</li>
							<!-- Downloads -->
							<li class="nav-item">
								<a class="nav-link" href="../downloads.html">Downloads</a>
							</li>
							<!-- Submit -->
							<li class="nav-item">
								<a class="nav-link" href="../submit.html">Submit!</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
		<!-- Main Content -->
		<div class="container">
			<!-- Statistics -->
			<div class="row">
				<div class="col-12">
					<div id="header-offset"></div>
					<h1>Statistics</h1>
					<h2 class="text-danger">Qualifiers</h2>
				</div>
			</div>
			<!-- Divider -->
			<div class="row">
				<div class="col-12">
					<hr style="margin-top: 0.25em;">
				</div>
			</div>
			<!-- Qualifiers Statistics -->
			<div class="row" style="text-align: center;">
				<div class="col-12 col-md-6">
					<h3>Difficulty Rating</h3>
					<canvas id="distroCanvas" width="1080" height="540" style="width: 100%; margin-bottom: 1.5em; font-family: inherit;">
						Your browser does not support the canvas element.
					</canvas>
				</div>
				<div class="col-12 col-md-6">
					<h3>Simfile Accumulation</h3>
					<canvas id="entryCanvas" width="1080" height="540" style="width: 100%; margin-bottom: 1.5em; font-family: inherit;">
						Your browser does not support the canvas element.
					</canvas>
				</div>
				<div class="col-12 col-md-6">
					<h3><span style="font-size: 87.5%;"># of Charts to Tracks by</span><br>Tokyo Machine</h3>
					<p style="font-size: 7em; font-weight: 100; margin: 0.5em 0 1em 0;">0</p>
				</div>
				<div class="col-12 col-md-6">
					<h3>Typical BPM </h3>
					<canvas id="bpmCanvas" width="1080" height="540" style="width: 100%; margin-bottom: 1.5em; font-family: inherit;">
						Your browser does not support the canvas element.
					</canvas>
				</div>
			</div>
		</div>
		<!-- Big Boy CTA -->
		<div class="container-fluid" id="bigboy">
			<!-- Submit Button -->
			<a id="bigbutton" href="../submit.html">Submit a File</a>
		</div>
		<!-- Footer -->
		<footer>
			<div class="container">
				&copy; 2020, All Rights Reserved | Website designed by <strong>Ryan &quot;xRGTMx&quot; Gudonis</strong>
			</div>
		</footer>
	</body>
	<script>
		function DP(x, y, isVertical)
		{
		  if (isVertical)
		  {
		    return [y, -x];
		  }
		  else
		  {
		    return [x, y];
		  }
		}
		
		function GP(D, eps)
		{
		  // Assume D is sorted and positive.
		  var D_unique = [];
		  var D_counts = [];
		  var D_last = -1;
		  for (i = 0; i < D.length; i++)
		  {
		    if (D_last + eps <= D[i])
		    {
		      D_last = D[i];
		      D_unique[D_unique.length] = D[i];
		      D_counts[D_counts.length] = 1;
		    }
		    else
		    {
		      D_counts[D_counts.length-1]++;
		    }
		  }
		  return [D_unique, D_counts];
		}
		function GP_Object(D, eps)
		{
		  // Assume D is sorted and positive.
		  var D_unique = [];
		  var D_counts = [];
		  var D_last = -1;
		  for (i = 0; i < D.length; i++)
		  {
		    if (D_last + eps <= D[i].v)
		    {
		      D_last = D[i].v;
		      D_unique[D_unique.length] = D[i].v;
		      D_counts[D_counts.length] = {halfof: 0, normal: 0, double: 0};
		    }
		
		    D_counts[D_counts.length-1].halfof += (D[i].s ==  1);
		    D_counts[D_counts.length-1].normal += (D[i].s ==  0);
		    D_counts[D_counts.length-1].double += (D[i].s == -1);
		  }
		  return [D_unique, D_counts];
		}
		
		function DrawRingPiece(ctx, centerX, centerY, angleS, angleF, lastInnerR, lastOuterR, thisInnerR, thisOuterR)
		{
		  ctx.beginPath();
		  ctx.moveTo(Math.cos(angleS)*lastInnerR + centerX, Math.sin(angleS)*lastInnerR + centerY);
		  if (lastInnerR != thisInnerR)
		  {
		    ctx.lineTo(Math.cos(angleF)*thisInnerR + centerX, Math.sin(angleF)*thisInnerR + centerY);
		  }
		  else
		  {
		    ctx.arc(centerX, centerY, lastInnerR, angleS, angleF, false);
		  }
		  ctx.lineTo(Math.cos(angleF)*thisOuterR + centerX, Math.sin(angleF)*thisOuterR + centerY);
		  if (lastOuterR != thisOuterR)
		  {
		    ctx.lineTo(Math.cos(angleS)*lastOuterR + centerX, Math.sin(angleS)*lastOuterR + centerY);
		  }
		  else
		  {
		    ctx.arc(centerX, centerY, lastOuterR, angleF, angleS, true);
		  }
		  ctx.closePath();
		  ctx.fill();
		  ctx.stroke();
		}
		
		function HSV(h, s, v)
		{
		  // Hue
		  var hfull = Math.floor(h * 6.0);
		  var hpart = h * 6.0 - hfull;
		
		  var rr = 0;
		  var gg = 0;
		  var bb = 0;
		  switch (hfull)
		      {
		      case 0:
		        rr = 1.0;
		        gg =       hpart;
		        bb = 0.0;
		        break;
		      case 1:
		        rr = 1.0 - hpart;
		        gg = 1.0;
		        bb = 0.0;
		        break;
		      case 2:
		        rr = 0.0;
		        gg = 1.0;
		        bb =       hpart;
		        break;
		      case 3:
		        rr = 0.0;
		        gg = 1.0 - hpart;
		        bb = 1.0;
		        break;
		      case 4:
		        rr =       hpart;
		        gg = 0.0;
		        bb = 1.0;
		        break;
		      default:
		        rr = 1.0;
		        gg = 0.0;
		        bb = 1.0 - hpart;
		  }
		
		  // Saturation, Value
		  //rr = (1 - s) * v + s * v * rr;
		  //gg = (1 - s) * v + s * v * gg;
		  //bb = (1 - s) * v + s * v * bb;
		  rr = v + s * v * (rr - 1);
		  gg = v + s * v * (gg - 1);
		  bb = v + s * v * (bb - 1);
		
		  var cc = 0x1000000 + 0x10000*Math.floor(255*rr) + 0x100*Math.floor(255*gg) + Math.floor(255*bb);
		  return "#" + cc.toString(16).substr(1);
		}
		
		function GraphDiffDistro()
		{   
		  var T = 0.8;    // bar thickness
		  var L = 0.15;   // leg end
		  var E = 0.1;    // bar view extension past max
		  var F = 0.1;    // text to separator
		  var G = 0.6;    // text sizing
		
		
		  var D = [0, 17, 45, 30, 15, 4, 3];
		  var S = ["≤ 9", "10", "11", "12", "13", "14", "≥15"];
		  var N = D.length;
		  var M = D.reduce(function(a,b) {return Math.max(a,b);});
		
		  var canvas = document.getElementById("distroCanvas");
		  var ctx = canvas.getContext("2d");
		  var W = canvas.width;
		  var H = canvas.height;
		
		
		  var sepX = W*L;
		  var textX = sepX*(1-F);
		  var dataH = H/N;
		  var barH = dataH*T;
		  var textY = (dataH+barH*G)*0.5;
		  var barY = (dataH-barH)*0.5;
		  var barL = W*(1-L)/(1+E);
		
		
		  // Create gradients
		  var grdFill = ctx.createLinearGradient(sepX, 0, W, 0);
		  grdFill.addColorStop(0.0, "#FF0000");
		  grdFill.addColorStop(0.5, "#FF6600");
		  grdFill.addColorStop(1.0, "#FFCC00");
		  var grdStrk = ctx.createLinearGradient(sepX, 0, W, 0);
		  grdStrk.addColorStop(0.0, "#FF0000");
		  grdStrk.addColorStop(0.5, "#FF6600");
		  grdStrk.addColorStop(1.0, "#FFCC00");
		
		
		  ctx.font = (barH*G).toString() + "px sans-serif"; // Lucida Console";
		  ctx.textAlign = "right";
		
		  for (i = 0; i < N; i++)
		  {
		    var thisBarL = barL * D[i]/M;
		    var x0 = sepX;
		      var y0 = dataH*i + barY;
		      var xx1 = thisBarL;
		      var yy1 = barH;
		      var x2 = textX;
		      var y2 = dataH*i + textY;
		
		      ctx.fillStyle = grdFill;
		      ctx.strokeStyle = grdStrk;
		      ctx.fillRect(x0, y0, xx1, yy1);
		      ctx.strokeRect(x0, y0, xx1, yy1);
		      
		    ctx.fillStyle = "#000000";
		    ctx.fillText(S[i], x2, y2);
		  }
		  //ctx.fillRect(30, 30, 30, 30);
		  ctx.lineWidth = 3;
		  ctx.beginPath();
		  ctx.moveTo(sepX, 0);
		  ctx.lineTo(sepX, H);
		  ctx.stroke();
		}
		
		function GraphBPMDistro()
		{   
		  var i;
		  var j;
		
		  var R = 0.5;    // inner radius
		  var T = 0.3;    // bar thickness
		  var L = 0.3;    // leg end
		  var F = 0.02;   // text to separator
		  var G = 0.5;    // text sizing
		  var P = 10;     // approx number of ticks overall minus 2 (end points of halving/doubling overlap)
		  var Q = 0.1;    // tick extension out of graph area
		  var Z = 0.3;    // shadowing effect in color
		  var B_eps = 0.100;  // BPM epsilon
		
		
		  var D = [84, 88, 94, 100, 104, 105, 105, 110, 110, 110, 110, 110, 110, 111.23, 112, 114, 114, 116, 119, 120, 123, 125, 125, 125, 125, 126, 126, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 129.986, 130, 130, 130, 130, 130, 130, 130.008, 131, 131, 131, 132, 132, 133, 134, 134, 134, 135, 138, 140, 140, 140, 140, 140, 142, 143, 143, 145, 145, 145, 146, 147, 147, 149.98, 150, 150, 150, 150, 150, 150, 150, 151.755, 152, 152, 153, 155, 155.036, 156, 160, 160, 160, 160, 160, 160, 165, 165, 168, 170, 170, 170, 172, 172, 173, 173, 175, 175, 175, 175, 175, 175, 175, 180, 180, 182, 185, 186, 186, 188, 190, 192, 200, 210, 210, 240];
		  var N = D.length;
		  var M = D.reduce(function(a,b) {return Math.max(a,b);});
		
		  
		  var D_dbl = [];
		  var H_dbl = 0;
		  for (i = 0; i < D.length; i++) {
		    D_dbl[i] = {v: D[i], s: 0};     // v = value, multiply by 2^s to obtain original
		  }
		  // Burn the fuse at both ends to determine where the best halving/doubling tails are.
		  for (i = 0; i < N / 2; i++)
		  {
		    if (D_dbl[i].v*2 > D_dbl[N-i-1].v)
		    {
		      H_dbl = i;
		      break;
		    }
		    else
		    {
		      D_dbl[i].v     *= 2;
		      D_dbl[i].s     -= 1;
		      D_dbl[N-i-1].v *= 0.5;
		      D_dbl[N-i-1].s += 1;
		    }
		  }
		  D_dbl.sort(function(a, b) {return a.v - b.v;});
		
		  // Group "equal" BPMs.
		  var tempGP = GP_Object(D_dbl, B_eps);
		  var D_grp = tempGP[0];
		  var D_cnt = tempGP[1];
		  var P_min = 2;
		
		
		  var canvas = document.getElementById("bpmCanvas");
		  var ctx = canvas.getContext("2d");
		  var W = canvas.width;
		  var H = canvas.height;
		
		
		  var minorAxis = Math.min(W, H)/2;
		  var centerX = W/2;
		  var centerY = H/2;
		  var innerR = minorAxis *  R;
		  var outerR = minorAxis * (R+T);
		  var exticR = minorAxis * (R+T+Q);
		
		  var textH  = minorAxis * (1-R-T) * G;
		
		
		
		  var N_process = 0;
		  var rampIn = 0;
		  var rampOut = 1;
		  for (i = 0; i < D_grp.length; i++)
		  {   
		    var sectorSz = D_cnt[i].halfof + D_cnt[i].normal + D_cnt[i].double;
		    var cycleMid = (N_process + sectorSz * 0.5 - H_dbl) / N;
		    var thetaMid = cycleMid * 2 * Math.PI;
		    var thetaSpan = sectorSz * 2 * Math.PI / N;
		    var angleS = thetaMid - 0.5 * thetaSpan;
		    var angleF = thetaMid + 0.5 * thetaSpan;
		
		    N_process += sectorSz;
		
		    // Smoothly transition into and out of halved/doubled BPMs.
		    var newRampIn  = (D_cnt[i].halfof) / sectorSz;
		    var newRampOut = (D_cnt[i].double ) / sectorSz;
		    var lastInnerR = outerR + (innerR - outerR) * rampIn;
		    var lastOuterR = innerR + (outerR - innerR) * rampOut;
		    var thisInnerR = outerR + (innerR - outerR) * newRampIn;
		    var thisOuterR = innerR + (outerR - innerR) * newRampOut;
		
		    ctx.lineWidth = 2;
		
		    ctx.strokeStyle = HSV(cycleMid % 1.0, 1.0, (1-1.5*Z));
		    ctx.fillStyle = HSV(cycleMid % 1.0, 1.0, (1-Z) + Z*cycleMid) + "FF";
		    DrawRingPiece(ctx, centerX, centerY, angleS, angleF, innerR, outerR, innerR, outerR);
		    ctx.fillStyle = HSV(cycleMid % 1.0, 1.0, (1-Z) + Z*(cycleMid-1)) + "FF";
		    DrawRingPiece(ctx, centerX, centerY, angleS, angleF, innerR, thisOuterR, innerR, thisOuterR);
		    ctx.fillStyle = HSV(cycleMid % 1.0, 1.0, (1-Z) + Z) + "FF";
		    DrawRingPiece(ctx, centerX, centerY, angleS, angleF, thisInnerR, outerR, thisInnerR, outerR);
		
		
		    // Tick, if necessary
		    var ticHalving  = Math.abs(D_grp[i]   - D[0]*2) < 0.01;
		    var ticDoubling = Math.abs(D_grp[i]*2 - D[N-1]) < 0.01;
		    if (sectorSz > P_min || ticHalving || ticDoubling)
		    {
		      var S_tic = (Math.round(D_grp[i])).toString();
		      if (ticHalving)
		      {
		        S_tic = (Math.round(D_grp[i] * 0.5)).toString() + " | " + S_tic;
		      }
		      if (ticDoubling)
		      {
		        S_tic = S_tic + " | " + (Math.round(D_grp[i] * 2)).toString();
		      }
		
		      var thisIntR = (innerR + thisInnerR + outerR + thisOuterR)*0.25;
		      var thisExtRV = exticR;
		      var thisExtRH = exticR * (W/H) * (1-L);
		      var thisExtXCorner = Math.cos(thetaMid)*thisExtRV + centerX;
		      var thisExtXEnd    = Math.cos(thetaMid)*thisExtRH + centerX;
		      var thisExtYCorner = Math.sin(thetaMid)*thisExtRV + centerY;
		
		      ctx.lineWidth = 3;
		      ctx.beginPath();
		      ctx.moveTo(Math.cos(thetaMid)*(thisIntR) + centerX, Math.sin(thetaMid)*(thisIntR) + centerY);
		      ctx.lineTo(thisExtXCorner, thisExtYCorner);
		      ctx.lineTo(thisExtXEnd,    thisExtYCorner);
		      ctx.stroke();
		
		      var sideSign = (Math.cos(thetaMid) < 0) ? -1 : 1;
		      var thisTextH = textH * (1.0 + 0.25*Math.log2(sectorSz / P_min));
		      ctx.font = (thisTextH).toString() + "px sans-serif"; // Lucida Console";
		      ctx.fillStyle = "#000000";
		      ctx.textAlign = (sideSign > 0) ? "left" : "right";
		      ctx.fillText(S_tic, thisExtXEnd + W*L*F*sideSign, thisExtYCorner + thisTextH*0.3);
		    }
		
		    rampIn = newRampIn;
		    rampOut = newRampOut;
		  }
		}
		
		
		function GraphEntryDate()
		{   
		  var T = 0.1;    // side to graph
		  var L = 0.1;    // leg end
		  var E = 0.1;    // bar view extension past max
		  var F = 0.15;   // text to separator
		  var G = 0.4;   // text sizing
		  var P = 20;     // cumulative occurrence tick spacing
		  var Q = 0.15;   // tick extension out of graph area
		
		
		            // Entry date distro is expressed as a negative logarithm
		  var D_pts = [-1.562, -1.562, -1.538, -1.538, -1.240, -1.240, -1.117, -1.117, -1.054, -1.054, -1.010, -1.010, -1.006, -1.006, -0.981, -0.958, -0.958, -0.864, -0.864, -0.834, -0.823, -0.823, -0.798, -0.794, -0.794, -0.754, -0.754, -0.570, -0.543, -0.543, -0.483, -0.483, -0.475, -0.475, -0.457, -0.457, -0.445, -0.445, -0.411, -0.411, -0.400, -0.400, -0.396, -0.396, -0.364, -0.364, -0.362, -0.345, -0.345, -0.331, -0.322, -0.322, -0.293, -0.293, -0.293, -0.150, -0.150, -0.132, -0.132, -0.107, -0.107, -0.080, -0.080, -0.024, -0.024, 0.025, 0.025, 0.138, 0.138, 0.219, 0.219, 0.253, 0.277, 0.277, 0.287, 0.287, 0.313, 0.313, 0.332, 0.332, 0.352, 0.352, 0.360, 0.360, 0.365, 0.365, 0.417, 0.437, 0.437, 0.556, 0.566, 0.566, 0.601, 0.601, 0.730, 0.730, 0.748, 0.748, 0.875, 0.875, 1.283, 1.283, 1.468, 1.468, 1.653, 1.653, 1.778, 1.778, 2.255, 2.255, 2.380, 2.380, 2.459, 2.459];
		  var D_tic = [-1.572, -1.447, -1.322, -1.146, -0.845, -0.602, -0.301, 0.000, 0.301, 0.602, 0.903, 1.079, 1.380, 1.505, 1.681, 1.857, 2.158, 2.459];
		  var S_tic = ["<", "4w", "3w", "2w", "1w", "4d", "2d", "1d", "12h", "6h", "3h", "2h", "1h", "45m", "30m", "20m", "10m", ">"];
		
		  var N = D_pts.length;
		  var M_max = D_pts.reduce(function(a,b) {return Math.max(a,b);});
		  var M_min = D_pts.reduce(function(a,b) {return Math.min(a,b);});
		  var N_tic = D_tic.length;
		
		  var canvas = document.getElementById("entryCanvas");
		  var ctx = canvas.getContext("2d");
		  var W = canvas.width;
		  var H = canvas.height;
		
		
		  var openX = W*T;
		  var closeX = W*(1-T);
		  var unitX = (closeX - openX) / (D_tic[D_tic.length-1] - D_tic[0]);
		  var unitY = H*(1-L) / (N*(1+E));
		  var sepY = H*(1-L);
		  var textH = H*L*G;
		  var textDateY = (H+sepY + H*L*G)*0.5; // Middle of tick mark area, plus baseline correction
		
		
		  // Create gradients
		  var grdFill = ctx.createLinearGradient(0, sepY, 0, 0);
		  grdFill.addColorStop(0.0, "#0000FF");
		  grdFill.addColorStop(0.5, "#00CCFF");
		  grdFill.addColorStop(1.0, "#99FFFF");
		  var grdStrk = ctx.createLinearGradient(0, sepY, 0, 0);
		  grdStrk.addColorStop(0.0, "#000066");
		  grdStrk.addColorStop(0.5, "#0000FF");
		  grdStrk.addColorStop(1.0, "#00FFFF");
		
		    ctx.fillStyle = "#000000";
		    ctx.strokeStyle = "#000066";
		
		  // Ticks (timeline)
		  ctx.lineWidth = 3;
		  ctx.beginPath();
		  ctx.moveTo(openX, 0);
		  ctx.lineTo(openX, sepY + H*L*Q);
		  ctx.stroke();
		  ctx.beginPath();
		  ctx.moveTo(closeX, 0);
		  ctx.lineTo(closeX, sepY + H*L*Q);
		  ctx.stroke();
		
		  ctx.lineWidth = 2;
		  ctx.font = (textH).toString() + "px sans-serif"; // Lucida Console";
		  ctx.textAlign = "center";
		  for (i = 0; i < N_tic; i++)
		  {
		    thisX = openX + unitX*(D_tic[i] - D_tic[0]);
		
		    ctx.beginPath();
		    ctx.moveTo(thisX, sepY);
		    ctx.lineTo(thisX, sepY + H*L*Q);
		    ctx.stroke();
		  
		    ctx.fillText(S_tic[i], thisX, sepY + H*L*Q*2 + textH*(0.5 + 1*(i%2)));
		  }
		
		  // Ticks (accumulation)
		  ctx.lineWidth = 3;
		  ctx.beginPath();
		  ctx.moveTo( openX - W*T*Q, sepY);
		  ctx.lineTo(closeX + W*T*Q, sepY);
		  ctx.stroke();
		
		  ctx.lineWidth = 2;
		  ctx.font = (textH).toString() + "px sans-serif"; // Lucida Console";
		  for (i = P; i < N*(1+E); i += P)
		  {
		    ctx.beginPath();
		    ctx.moveTo( openX - W*T*Q, sepY - unitY*i);
		    ctx.lineTo(closeX + W*T*Q, sepY - unitY*i);
		    ctx.stroke();
		  
		    ctx.textAlign = "right";
		    ctx.fillText(i.toString(),  openX - W*T*Q*2, sepY - unitY*i + textH*0.5);
		    ctx.textAlign = "left";
		    ctx.fillText(i.toString(), closeX + W*T*Q*2, sepY - unitY*i + textH*0.5);
		  }
		
		
		  // Data drawing path
		    ctx.fillStyle = grdFill;
		    ctx.strokeStyle = grdStrk;
		    ctx.lineWidth = 3;
		    ctx.beginPath();
		    ctx.moveTo(openX, sepY);
		    var lastY = sepY;
		  for (i = 0; i < N; i++)
		  {
		    var thisX = openX + unitX*(D_pts[i] - D_pts[0]);
		    var thisY = sepY  - unitY*(i+1);
		
		    ctx.lineTo(thisX, lastY);
		    ctx.lineTo(thisX, thisY);
		
		    lastY = thisY;
		  }
		  ctx.lineTo(closeX, sepY - unitY*N);
		  ctx.lineTo(closeX, sepY);
		  ctx.closePath();
		  ctx.fill();
		  ctx.stroke();
		}
		
		GraphDiffDistro();
		GraphEntryDate();
		GraphBPMDistro();
	</script>
</html>